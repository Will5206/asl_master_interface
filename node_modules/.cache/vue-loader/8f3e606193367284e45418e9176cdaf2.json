{"remainingRequest":"/Users/will5206/Desktop/master_interface/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/will5206/Desktop/master_interface/src/components/Timeline.vue?vue&type=style&index=0&id=7f3aebf1&lang=scss&scoped=true","dependencies":[{"path":"/Users/will5206/Desktop/master_interface/src/components/Timeline.vue","mtime":1705646185482},{"path":"/Users/will5206/Desktop/master_interface/node_modules/css-loader/dist/cjs.js","mtime":1704319707203},{"path":"/Users/will5206/Desktop/master_interface/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1704319707425},{"path":"/Users/will5206/Desktop/master_interface/node_modules/postcss-loader/src/index.js","mtime":1704319707260},{"path":"/Users/will5206/Desktop/master_interface/node_modules/sass-loader/dist/cjs.js","mtime":1704319707089},{"path":"/Users/will5206/Desktop/master_interface/node_modules/cache-loader/dist/cjs.js","mtime":1704319707089},{"path":"/Users/will5206/Desktop/master_interface/node_modules/vue-loader/lib/index.js","mtime":1704319707297}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgIkAvYXNzZXRzL3N0eWxlcy9fdmFyaWFibGVzLnNjc3MiOwpAaW1wb3J0ICJAL2Fzc2V0cy9zdHlsZXMvX21peGlucy5zY3NzIjsKCiN0aW1lbGluZSB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGJhY2tncm91bmQtcG9zaXRpb24teTogY2VudGVyOwogIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgYm9yZGVyOiAycHggc29saWQgIzMzMzsKCiAgJjpob3ZlciB7CiAgICAvLyBjdXJzb3I6IHRleHQ7CiAgICAjcGhhbnRvbS10aWNrLmNhbi1zaG93IHsKICAgICAgZGlzcGxheTogYmxvY2s7CiAgICB9CiAgfQp9CgokYjogMnB4OwokcDogMHB4OwokdzogNHB4OwokbV93OiAzOwokYnI6IDAuMzNyZW07Cgojc2VsZWN0aW9uIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAkcDsKICBib3R0b206ICRwOwogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zMyk7CiAgYm9yZGVyLXRvcDogJGIgc29saWQgJGFjY2VudDsKICBib3JkZXItYm90dG9tOiAkYiBzb2xpZCAkYWNjZW50OwogIGJvcmRlci1yYWRpdXM6ICRicjsKICB6LWluZGV4OiAxOwoKICBjdXJzb3I6IGdyYWI7CiAgJi5kcmFnZ2luZyB7CiAgICBjdXJzb3I6IGdyYWJiaW5nOwogIH0KfQoKLnNlbGVjdGlvbi1ib3VuZGFyeSB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogLSRiOwogIGJvdHRvbTogLSRiOwoKICBjdXJzb3I6IGV3LXJlc2l6ZTsKCiAgYm9yZGVyLXdpZHRoOiAwOwogIGJvcmRlci1jb2xvcjogJGFjY2VudDsKICBib3JkZXItc3R5bGU6IHNvbGlkOwoKICB6LWluZGV4OiAzOwogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OwogIHBhZGRpbmc6IDA7CiAgdHJhbnNpdGlvbjogYm9yZGVyLXdpZHRoIDAuMzNzIGVhc2U7CgogIHdpZHRoOiAkdyAqICRtX3c7CiAgJjpob3ZlciB7CiAgICB3aWR0aDogJHcgKiAoJG1fdyArIDEpOwogIH0KCiAgJiNzdGFydCB7CiAgICBib3JkZXItbGVmdC13aWR0aDogJHc7CiAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAkYnI7CiAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAkYnI7CiAgICAmOmhvdmVyIHsKICAgICAgYm9yZGVyLWxlZnQtd2lkdGg6ICR3ICogJG1fdzsKICAgIH0KICB9CiAgJiNlbmQgewogICAgcmlnaHQ6IDA7CiAgICBib3JkZXItcmlnaHQtd2lkdGg6ICR3OwogICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6ICRicjsKICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAkYnI7CiAgICAmOmhvdmVyIHsKICAgICAgYm9yZGVyLXJpZ2h0LXdpZHRoOiAkdyAqICRtX3c7CiAgICB9CiAgfQp9CgoudGljayB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHBvaW50ZXItZXZlbnRzOiBub25lOwogIG9wYWNpdHk6IDE7CiAgei1pbmRleDogNDsKfQoKI3BoYW50b20tdGljayB7CiAgdG9wOiAwOwogIGJvdHRvbTogMDsKICB6LWluZGV4OiAzOwogIHdpZHRoOiAxcHg7CiAgYm9yZGVyLWxlZnQ6IDFweCBkb3R0ZWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwoKICBkaXNwbGF5OiBub25lOwp9CgojbWFpbi10aWNrIHsKICB0b3A6IC0zcHg7CiAgYm90dG9tOiAtM3B4OwogIHdpZHRoOiAzcHg7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMXB4KTsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICBib3JkZXItbGVmdDogMXB4IHNvbGlkIHdoaXRlOwogIGJvcmRlci1yaWdodDogMXB4IHNvbGlkIHdoaXRlOwoKICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXMgZWFzZTsKCiAgJi50aWNrZXItZWxzZXdoZXJlIHsKICAgIG9wYWNpdHk6IDAuMjsKICB9Cn0KCi5kdXJhdGlvbiB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHVzZXItc2VsZWN0OiBub25lOwogIEBpbmNsdWRlIGZzKC0yKTsKICBmb250LXdlaWdodDogNDUwOwogIGNvbG9yOiAjZGRkOwogICYuc3RhcnQsCiAgJi5lbmQgewogICAgdG9wOiAtMjRweDsKICB9CiAgJi5ib3VuZGFyeSB7CiAgICBmb250LXdlaWdodDogNzAwOwogICAgdG9wOiA1MCU7CiAgICB6LWluZGV4OiA0OwogICAgJi5sZWZ0IHsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHRyYW5zbGF0ZVgoY2FsYygtMTAwJSAtIDAuNWNoKSk7CiAgICB9CiAgICAmLmxlZnQuaW5uZXIgewogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSkgdHJhbnNsYXRlWChjYWxjKDAuNWNoICsgMTJweCkpOwogICAgfQogICAgJi5yaWdodCB7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSB0cmFuc2xhdGVYKGNhbGMoMTAwJSArIDAuNWNoKSk7CiAgICB9CiAgICAmLnJpZ2h0LmlubmVyIHsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHRyYW5zbGF0ZVgoY2FsYygtMC41Y2ggLSAxMnB4KSk7CiAgICB9CiAgICBjb2xvcjogJGFjY2VudDsKICB9CiAgJi5zdGFydCB7CiAgICBsZWZ0OiAwOwogIH0KICAmLmVuZCB7CiAgICByaWdodDogMDsKICB9CiAgJi5ib3VuZGFyeSB7CiAgfQp9CgpjYW52YXMgewogIGRpc3BsYXk6IG5vbmU7Cn0K"},{"version":3,"sources":["Timeline.vue"],"names":[],"mappings":";AA0WA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Timeline.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div\n    id=\"timeline\"\n    @mousemove=\"mouseMove\"\n    @mouseup=\"mouseUp\"\n    @mouseleave=\"endAllDragging\"\n  >\n    <canvas id=\"bg-canvas\" :width=\"width\" :height=\"height\" />\n    <div\n      id=\"selection\"\n      :class=\"{ dragging: draggingBlock }\"\n      :style=\"{\n        left: leftPos,\n        right: rightPos,\n        backgroundPositionX: backgroundOffset,\n        backgroundPositionY: `-2px`,\n      }\"\n      @mousedown=\"startDraggingBlock\"\n    >\n      <button\n        id=\"start\"\n        class=\"selection-boundary\"\n        @mousedown=\"startDraggingStart\"\n      />\n      <button\n        id=\"end\"\n        class=\"selection-boundary\"\n        @mousedown=\"startDraggingEnd\"\n      />\n    </div>\n    <div\n      id=\"main-tick\"\n      class=\"tick\"\n      :class=\"{\n        playing: playing,\n        'ticker-elsewhere': draggingStart || draggingEnd,\n      }\"\n      :style=\"{ left: tickPosition }\"\n    />\n    <div\n      id=\"phantom-tick\"\n      class=\"tick\"\n      :class=\"{ 'can-show': canShowPhantomTick }\"\n    />\n    <p class=\"duration start\">{{ shownDuration[0] }}</p>\n    <p class=\"duration end\">{{ shownDuration[1] }}</p>\n    <p\n      id=\"left-boundary\"\n      class=\"duration boundary left\"\n      :class=\"leftBoundaryPosition\"\n      :style=\"{ left: leftPos }\"\n    >\n      {{ shownDuration[2] }}\n    </p>\n    <p\n      id=\"right-boundary\"\n      class=\"duration boundary right\"\n      :class=\"rightBoundaryPosition\"\n      :style=\"{ right: rightPos }\"\n    >\n      {{ shownDuration[3] }}\n    </p>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Timeline\",\n  data() {\n    return {\n      startX: -1,\n      endX: -1,\n      offsetX: 0,\n      buttonWidth: -1,\n      initialMouseX: -1,\n      initialStartX: -1,\n      initialEndX: -1,\n      initialPosition: -1,\n      draggingBlock: false,\n      draggingStart: false,\n      draggingEnd: false,\n      selectionEl: null,\n      rect: null,\n      height: null,\n      width: null,\n      canvas: null,\n      ctx: null,\n      howManyDrawn: 0,\n    };\n  },\n  watch: {\n    frameBaseName: function () {\n      this.setupBackground();\n    },\n  },\n  mounted() {\n    this.canvas = document.getElementById(\"bg-canvas\");\n    this.ctx = this.canvas.getContext(\"2d\");\n\n    this.selectionEl = document.getElementById(\"selection\");\n\n    this.updateWidthDefs();\n    this.setupBackground(); // first time\n    let el = document.getElementById(\"start\");\n    this.buttonWidth = el.offsetWidth * 2;\n    new ResizeObserver(this.updateWidthDefs).observe(this.$el);\n\n    let windowResize;\n    window.onresize = () => {\n      clearTimeout(windowResize);\n      // will only redraw bg if there was no resize in 50ms\n      // as per https://stackoverflow.com/a/5490021/888094\n      windowResize = setTimeout(this.setupBackground, 50);\n    };\n  },\n  computed: {\n    canShowPhantomTick: function () {\n      return !this.draggingBlock && !this.draggingStart && !this.draggingEnd;\n    },\n    shownDuration: function () {\n      if (\n        this.duration == -1 ||\n        this.startX == -1 ||\n        this.endX == -1 ||\n        !this.duration\n      ) {\n        return [\"\", \"\", \"\", \"\"];\n      }\n      return [\n        \"0\",\n        Math.round(this.duration),\n        (this.startX * this.duration).toFixed(1),\n        (this.endX * this.duration).toFixed(1),\n      ];\n    },\n    leftBoundaryPosition: function () {\n      let el = document.getElementById(\"left-boundary\"),\n        left = this.startX * this.width;\n      if (!el || left <= el.offsetWidth) {\n        return \"inner\";\n      }\n      return \"outer\";\n    },\n    rightBoundaryPosition: function () {\n      let el = document.getElementById(\"right-boundary\"),\n        right = (1 - this.endX) * this.width;\n      if (!el || right <= el.offsetWidth) {\n        return \"inner\";\n      }\n      return \"outer\";\n    },\n    tickPosition: function () {\n      if (!this.width || !this.rect) {\n        return \"\";\n      }\n      if (this.draggingStart || this.draggingEnd) {\n        return `${this.initialPosition * 100}%`;\n      }\n      return `${this.position * 100}%`;\n    },\n    startP: function () {\n      return this.startX / this.width;\n    },\n    endP: function () {\n      return this.endX / this.width;\n    },\n    backgroundOffset: function () {\n      if (!this.rect) {\n        return \"\";\n      }\n      if (this.startX < this.endX) {\n        return -(this.startX * this.width) + \"px\";\n      }\n      return -(this.endX * this.width) + \"px\";\n    },\n    leftPos: function () {\n      if (!this.rect) {\n        return \"\";\n      }\n      if (this.startX < this.endX) {\n        return `calc(${this.startX * 100}%)`;\n      }\n      return this.endX * 100 + \"%\";\n    },\n    rightPos: function () {\n      if (!this.rect) {\n        return \"\";\n      }\n      if (this.endX > this.startX) {\n        return (1 - this.endX) * 100 + \"%\";\n      }\n      return (1 - this.startX) * 100 + \"%\";\n    },\n  },\n  methods: {\n    resetSelection: function () {\n      this.startX = 0;\n      this.endX = 1;\n      this.endAllDragging();\n    },\n    setupBackground: function () {\n      let desiredWidth = Math.max(96, Math.floor(this.width / this.duration)), // one frame per second, with min width of 48.\n        height = (desiredWidth * 9) / 16,\n        offsetY = Math.max(0, (this.$el.offsetHeight - height) / 2 - 4),\n        maxIndex = this.frameNumber,\n        minIndex = 1,\n        count = Math.floor(this.width / desiredWidth),\n        diff = (this.width - count * desiredWidth) / (count - 1);\n\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.howManyDrawn = 0;\n      for (let i = 0; i < count; i++) {\n        let index =\n          Math.floor((i / count) * (maxIndex - minIndex) + minIndex) + \"\";\n        let img = new Image();\n        let path = `/frames/${this.frameBaseName}${index.padStart(3, \"0\")}.jpg`;\n        img.src = path;\n        img.onload = () => {\n          this.ctx.drawImage(\n            img,\n            i * (desiredWidth + diff),\n            offsetY,\n            desiredWidth,\n            height\n          );\n          this.howManyDrawn++;\n\n          // is this the last call back?\n          if (this.howManyDrawn == count) {\n            this.selectionEl.style.background = `url(${this.canvas.toDataURL()})`;\n            this.ctx.fillStyle = \"rgba(0,0,0,0.66)\";\n            this.ctx.fillRect(0, 0, this.width, this.height);\n            this.$el.style.background = `url(${this.canvas.toDataURL()})`;\n          }\n        };\n      }\n    },\n    updateWidthDefs: function () {\n      this.rect = this.$el.getBoundingClientRect();\n      if (this.startX == -1) {\n        this.startX = 0;\n        this.endX = 1;\n      }\n      if (this.width == null) {\n        this.width = this.$el.offsetWidth;\n        this.height = this.$el.offsetHeight;\n      } else {\n        let newWidth = this.$el.offsetWidth;\n\n        this.width = newWidth;\n        this.height = this.$el.offsetHeight;\n      }\n    },\n    mouseUp: function (e) {\n      if (\n        !this.draggingStart &&\n        !this.draggingEnd &&\n        (!this.draggingBlock || this.initialMouseX == e.clientX)\n      ) {\n        this.$emit(\n          \"change-position\",\n          (e.clientX - this.rect.left) / this.width\n        );\n      }\n      this.endAllDragging();\n    },\n    endAllDragging: function () {\n      if (this.draggingStart || this.draggingEnd) {\n        // moves the ticker back to wherever it was\n        this.$emit(\"change-position\", this.initialPosition);\n      }\n      this.draggingStart = false;\n      this.draggingEnd = false;\n      this.draggingBlock = false;\n\n      let boundaries = { start: this.startX, end: this.endX };\n      this.$emit(\"change\", boundaries);\n    },\n    startDraggingBlock: function (e) {\n      this.initialMouseX = e.clientX;\n      this.initialStartX = this.startX;\n      this.initialEndX = this.endX;\n      this.initialPosition = this.position;\n      this.draggingBlock = true;\n    },\n    startDraggingStart: function (e) {\n      let el = document.getElementById(\"start\");\n      let bound = el.getBoundingClientRect();\n      this.offsetX = e.clientX - bound.left;\n      this.draggingStart = true;\n    },\n    startDraggingEnd: function (e) {\n      let el = document.getElementById(\"end\");\n      let bound = el.getBoundingClientRect();\n      this.offsetX = e.clientX - bound.right;\n      this.draggingEnd = true;\n    },\n    mouseMove: function (event) {\n      let x = event.clientX - this.rect.left - this.offsetX;\n      if (this.draggingStart) {\n        if ((x + this.buttonWidth) / this.width < this.endX) {\n          this.startX = Math.max(x / this.width, 0);\n          this.$emit(\"change-position\", this.startX);\n        }\n      } else if (this.draggingEnd) {\n        if ((x - this.buttonWidth) / this.width > this.startX) {\n          this.endX = Math.min(x / this.width, 1);\n          this.$emit(\"change-position\", this.endX);\n        }\n      } else if (this.draggingBlock) {\n        let offset = this.initialMouseX - event.clientX;\n        let change = offset / this.width;\n        if (\n          this.initialStartX - change >= 0 &&\n          this.initialEndX - change <= 1\n        ) {\n          this.startX = this.initialStartX - change;\n          this.endX = this.initialEndX - change;\n        } else {\n          // this is just so we don't have a very small left over value either at the start or end\n          if (this.initialStartX - change <= 0) {\n            this.endX -= this.startX;\n            this.startX = 0;\n          } else {\n            this.startX -= 1 - this.endX;\n            this.endX = 1;\n          }\n        }\n      } else {\n        // phantom tick\n        let el = document.getElementById(\"phantom-tick\");\n        el.style.left =\n          ((event.clientX - this.rect.left) / this.width) * 100 + \"%\";\n      }\n    },\n  },\n  props: {\n    frameBaseName: {\n      type: String,\n      default: \"frame\",\n    },\n    frameNumber: {\n      type: Number,\n      default: 100,\n    },\n    duration: {\n      type: Number,\n      default: -1,\n    },\n    playing: {\n      type: Boolean,\n      default: false,\n    },\n    position: {\n      type: Number,\n      default: 0,\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/assets/styles/_variables.scss\";\n@import \"@/assets/styles/_mixins.scss\";\n\n#timeline {\n  position: relative;\n  background-position-y: center;\n  background-repeat: no-repeat;\n  border: 2px solid #333;\n\n  &:hover {\n    // cursor: text;\n    #phantom-tick.can-show {\n      display: block;\n    }\n  }\n}\n\n$b: 2px;\n$p: 0px;\n$w: 4px;\n$m_w: 3;\n$br: 0.33rem;\n\n#selection {\n  position: absolute;\n  top: $p;\n  bottom: $p;\n  background-color: rgba(255, 255, 255, 0.33);\n  border-top: $b solid $accent;\n  border-bottom: $b solid $accent;\n  border-radius: $br;\n  z-index: 1;\n\n  cursor: grab;\n  &.dragging {\n    cursor: grabbing;\n  }\n}\n\n.selection-boundary {\n  position: absolute;\n  top: -$b;\n  bottom: -$b;\n\n  cursor: ew-resize;\n\n  border-width: 0;\n  border-color: $accent;\n  border-style: solid;\n\n  z-index: 3;\n  background-color: transparent;\n  padding: 0;\n  transition: border-width 0.33s ease;\n\n  width: $w * $m_w;\n  &:hover {\n    width: $w * ($m_w + 1);\n  }\n\n  &#start {\n    border-left-width: $w;\n    border-top-left-radius: $br;\n    border-bottom-left-radius: $br;\n    &:hover {\n      border-left-width: $w * $m_w;\n    }\n  }\n  &#end {\n    right: 0;\n    border-right-width: $w;\n    border-top-right-radius: $br;\n    border-bottom-right-radius: $br;\n    &:hover {\n      border-right-width: $w * $m_w;\n    }\n  }\n}\n\n.tick {\n  position: absolute;\n  pointer-events: none;\n  opacity: 1;\n  z-index: 4;\n}\n\n#phantom-tick {\n  top: 0;\n  bottom: 0;\n  z-index: 3;\n  width: 1px;\n  border-left: 1px dotted rgba(255, 255, 255, 0.5);\n\n  display: none;\n}\n\n#main-tick {\n  top: -3px;\n  bottom: -3px;\n  width: 3px;\n  border-radius: 4px;\n  transform: translateX(-1px);\n  background-color: white;\n  border-left: 1px solid white;\n  border-right: 1px solid white;\n\n  transition: opacity 0.5s ease;\n\n  &.ticker-elsewhere {\n    opacity: 0.2;\n  }\n}\n\n.duration {\n  position: absolute;\n  user-select: none;\n  @include fs(-2);\n  font-weight: 450;\n  color: #ddd;\n  &.start,\n  &.end {\n    top: -24px;\n  }\n  &.boundary {\n    font-weight: 700;\n    top: 50%;\n    z-index: 4;\n    &.left {\n      transform: translateY(-50%) translateX(calc(-100% - 0.5ch));\n    }\n    &.left.inner {\n      transform: translateY(-50%) translateX(calc(0.5ch + 12px));\n    }\n    &.right {\n      transform: translateY(-50%) translateX(calc(100% + 0.5ch));\n    }\n    &.right.inner {\n      transform: translateY(-50%) translateX(calc(-0.5ch - 12px));\n    }\n    color: $accent;\n  }\n  &.start {\n    left: 0;\n  }\n  &.end {\n    right: 0;\n  }\n  &.boundary {\n  }\n}\n\ncanvas {\n  display: none;\n}\n</style>\n"]}]}